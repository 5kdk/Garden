# **9장 타입변환과 단축평가**

<br>

- [**9장 타입변환과 단축평가**](#9장-타입변환과-단축평가)
  - [**들어가며 🎈**](#들어가며-)
  - [**타입변환은 무엇인가?**](#타입변환은-무엇인가)
  - [**명시적 타입 변환 vs. 암묵적 타입 변환**](#명시적-타입-변환-vs-암묵적-타입-변환)
    - [**암묵적 타입 변환**](#암묵적-타입-변환)
    - [**3가지 타입의 암묵적 타입 변환**](#3가지-타입의-암묵적-타입-변환)
    - [**명시적 타입 변환**](#명시적-타입-변환)
    - [**암묵적 타입 변환**](#암묵적-타입-변환-1)
  - [**단축 평가**](#단축-평가)
    - [**단축 평가 규칙**](#단축-평가-규칙)
    - [**세가지 방법의 단축 평가**](#세가지-방법의-단축-평가)

<br>

## **들어가며 🎈**

본 정리글은 이웅모강사님의 모던 자바스크립트 Deep Dive를 공부하고 습득하기 위해 제 나름대로 정리한 글 입니다. 보다 상세한 정보를 원하신다면 해당 서적을 참고하시길 바랍니다.

<br>

## **타입변환은 무엇인가?**

자바스크립트의 모든 값은 타입이 있는데 개발자의 의도가 있냐 없냐에 따라, 명시적 타입변환(혹은 타입캐스팅)과 암묵적 타입 변환(혹은 타입강제 변환) 두 가지로 나뉨

```javascript
var x = 10;

// 명시적 타입 변환 예
var str = x.toString();

// 암묵적 타입 변환 예
var str2 = x + '';
```

타입변환에서 꼭 알아야할 점은 타입변환이 기존 원시 값을 직접 변경하는 것은 아니고 기존 원시 값을 사용해 다른 타입의 새로운 원시 값을 생성 하는 것이다.

```javascript
console.log(typeof str, str); // string 10
console.log(typeof x, x); // number 10
```

즉, 기존 변수 값을 재할당하여 변경하는 것이 아니라 자바스크립트 엔진이 표현식을 에러 없이 평가하기 위해 피연산자의 값을 암묵적 타입 변환해 새로운 타입의 값을 만들어 단 한 번 사용하고 버린다.

<br>

---

## **명시적 타입 변환 vs. 암묵적 타입 변환**

### **암묵적 타입 변환**

자바스크립트 엔진이 표현식을 평가할 때 개발자의 의도와는 상관없이 코드의 문맥을 고려해 타입을 강제 변환 시킨다

```javascript
// 문자열 문맥
'10' + 2; // -> '102'

// 숫자타입 문맥
5 * '10'; // -> 50

// 불리언 타입 문맥
!0; // -> true
if (1) {
}
```

<br>

### **3가지 타입의 암묵적 타입 변환**

- 문자열
  - `+` 문자열 연결 연산자 사용 시 피연산자 중 하나 이상이 문자열인 경우 코드 문맥상 모두 문자열 타입이여야 하기 때문에 피연산자를 암묵적으로 문자열로 변환시킴
  - ES6에서 도임된 템플릿 리터럴의 표현식 삽입은 표현식 평가 결과를 문자열 타입으로 암묵적 타입 변환시킴

<br>  
  
- 숫자타입
  - 산술 연산자 사용시 모든 피연산자는 코드 문맥상 모두 숫자 타입이어야 하기 때문에 피연산자를 숫자타입으로 변환시킨다.
  - 비교 연산자 사용시 피연산자의 크기를 비교하므로 마찬가지로 숫자 타입이어야 한다 따라서 숫자타입으로 변환시킨다.
  - `+` 단항 연산자는 피연산자가 숫자 타입의 값이 아닌면 숫자 타입의 값으로 암묵적 타입 변환시킨다.
  - 빈 문자열(`''`), 빈 배열(`[]`), `null`, `false`는 `0`으로, `true`는 `1`로 변환됨
  - 만약, 변환시킬 수 없다면 `NaN`으로 변환시킨다 (객체, 빈 배열이 아닌 배열, `undefined`)

<br>

- 불리언 타입
  - 자바스크립트 엔진은 불리언 타입이 아닌 값을 Truthy 값(참으로 평가되는 값) 또는 Falsy 값(거짓으로 평가되는 값)으로 구분하고 제어문의 조건식과 같이 불리언 값으로 평가되어야 할 문맥해서 `true`, `false`로 암묵적 타입 변환된다.
    - false로 평가되는 Falsy 값
      - `false`
      - `undefined`
      - `null`
      - `0`, `-0`
      - `NaN`
      - `''`(빈 문자열)
  - Falsy 값 이외엔 모두 `true`로 평가되는 Truthy 값이다.

<br>

### **명시적 타입 변환**

명시적으로 타입을 변경하는 방법은?

- 표준 빌트인 생성자 함수 `String`, `Number`, `Boolean`를 `new` 연산자 없이 호출하는 방법
- 빌트인 메서드를 사용한 방법
- 암묵적 타입 변환을 의도적으로 사용하는 방법

<br>

### **암묵적 타입 변환**

- 문자열
  - `String` 생성자 함수 (`new` 연산자 없이)
  - `Obejct.prototype.toString` 메서드 사용
  - 문자열 연결 연산자 `+` 사용
- 숫자 타입
  - Number 생성자 함수
  - `parseInt`, `parseFloat` 함수 사용 (문자열만 숫자 타입으로 변환 가능)
  - `+`단항 산술 연산자를 이용한 방법
  - `*`산술 연산자를 이용한 방법
- 불리언 타입
  - `Boolean` 생성자 함수를 `new` 연산자 없이 호출하는 방법
  - `!` 부정 논리 연산자를 두 번 사용하는 방법

<br>

---

## **단축 평가**

단축 평가는 표현식을 평가하는 도중에 평가결과가 확정된 경우나머지 평가 과정을 생략하는 것

### **단축 평가 규칙**

| 단축 평가 표현식  | 평가 결과 |
| ----------------- | --------- |
| true \|\| anything  | true      |
| false \|\| anything | anything  |
| true && anything  | anything  |
| false && anything | false     |


<br>

### **세가지 방법의 단축 평가**

- 논리 연산자를 사용한 단축 평가

  - `if`문 대체<br>어떤 조건이 Truthy 값일 때 무언가 해야 한다면 논리곱(`&&`)연산자 표현식으로, 어떤 조건이 Falsy 값 일 때 무언가를 해야 한다면 논리합(`||`) 연산자 표현식으로 `if`문 대체한다.

    ```javascript
    var done = true;
    var message = '';

    // 주어진 조건이 true일 떄
    if (done) message = '완료';

    // if 문은 단축 평가로 대체 가능
    message = done && '완료';
    console.log(message); // 완료
    ```

  - 객체를 가리키기를 기대하는 변수가 `null` 또는 `undefined`가 아닌지 확인하고 프로퍼티를 참조할 때
    ```javascript
    var elem = null;
    var value = elem && elem.value; // -> null, 그냥 접근하면 TypeError
    ```
  - 함수 매개변수에 기본값을 설정할 때

    ```javascript
    // 단축 평가를 사용한 매개변수의 기본값 설정
    function getStringLength(str) {
      str = str || '';
      return str.length;
    }

    // 참고 ES6의 매개변수의 기본값 설정
    function getStringLength(str = '') {
      return str.length;
    }
    ```

- 옵셔널 체이닝 연산자

  - ES11에서 도입된 연산자 `?.`는 좌항의 피연산자가 `null` 또는 `undefined`인 경우 `undefined`를 반환하고, 그렇지 않으면 우항의 프로퍼티 참조를 이어간다.
  - 옵셔널 체이닝이 도입되기 전엔 논리연산자 `&&`로 단축평가를 해서 좌항 값을 확인했는데 연산자의 좌항 피연산자가 Falsy 값인 `0`이나 `''`인 경우 객체로 평가될 때가 있어 예기치 못한 동작이 발생할 수도 있다.

    ```javascript
    var str = '';

    var length = str?.length;
    ```

- null 병합 연산자

  - ES11에서 도입된 `null` 병합 연산자 `??`는 좌항의 피연산자가 `null` 또는 `undefined`인 경우 우항의 피연산자를 반환하고, 그렇지 않으면 좌항의 피연산자를 반환한다.
  - 변수에 기본값을 설정할 때 유용하다.

    ```javascript
    var foo = null ?? 'default string';

    console.log(foo); // 'default string'
    ```
